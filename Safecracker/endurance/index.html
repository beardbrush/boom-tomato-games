<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<link rel="manifest" href="../manifest.json">

<meta name="theme-color" content="#0b0704">

<title>SAFECRACKER — ENDURANCE RUN</title>
<style>
  :root{
    --bg0:#0b0704;
    --bg1:#15100a;

    --brass:#caa35a;
    --ink:#f3e7cf;
    --dim:rgba(243,231,207,.70);

    --line:rgba(202,163,90,.28);
    --line2:rgba(202,163,90,.14);

    --good:rgba(160,255,210,.85);
    --bad:rgba(255,120,140,.85);
    --warn:rgba(255,210,120,.85);

    --shadow: 0 14px 40px rgba(0,0,0,.55);
    --radius: 14px;

    --pad: 12px;
    --gap: 12px;
    --topH: 58px;
    --botH: 48px;
  }

  *{box-sizing:border-box;}
  html,body{
touch-action: manipulation;
  overscroll-behavior: none;
    height:100%;
    margin:0;
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
    color:var(--ink);
    background:
      radial-gradient(900px 500px at 25% 20%, rgba(202,163,90,.08), transparent 60%),
      radial-gradient(700px 500px at 80% 70%, rgba(255,180,90,.05), transparent 55%),
      linear-gradient(180deg,var(--bg0),var(--bg1));
    overflow:hidden;
  }
  *::-webkit-scrollbar{width:0;height:0;}
  *{scrollbar-width:none;}

  .grain,.vignette{pointer-events:none; position:fixed; inset:0; z-index:50;}
  .grain{
    opacity:.10;
    background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.6'/%3E%3C/svg%3E");
    background-size:220px 220px;
    mix-blend-mode:soft-light;
    animation: drift 1.6s steps(2,end) infinite;
  }
  @keyframes drift{
    0%{transform:translate(0,0);}
    25%{transform:translate(-2px,1px);}
    50%{transform:translate(2px,-1px);}
    75%{transform:translate(-1px,-2px);}
    100%{transform:translate(0,0);}
  }
  .vignette{
    background: radial-gradient(circle at 50% 42%, rgba(0,0,0,0) 35%, rgba(0,0,0,.65) 100%);
    opacity:.85;
  }

  .wrap{
    height:100%;
    display:grid;
    grid-template-rows: var(--topH) 1fr var(--botH);
    gap:var(--gap);
    padding:var(--pad);
  }
.safeWrap{
  max-width: 92vmin;
  max-height: 92vmin;
  aspect-ratio: 1 / 1;
  margin: auto;
}


  .bar{
    background: linear-gradient(180deg, rgba(30,20,12,.75), rgba(10,7,4,.55));
    border:1px solid var(--line2);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    position:relative;
    overflow:hidden;
  }
  .bar::before{
    content:"";
    position:absolute; inset:0;
    background: linear-gradient(90deg, transparent, rgba(202,163,90,.12), transparent);
    transform:translateX(-70%);
    animation:sheen 7.2s linear infinite;
    opacity:.55;
  }
  @keyframes sheen{to{transform:translateX(170%);}}
  .bar .row{
    position:relative;
    height:100%;
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:10px 12px;
    gap:12px;
    min-width:0;
  }

  .pill{
    border:1px solid var(--line2);
    border-radius:999px;
    padding:6px 10px;
    background: rgba(0,0,0,.18);
    letter-spacing:.14em;
    text-transform:uppercase;
    color:var(--dim);
    white-space:nowrap;
  }
  .pill b{color:var(--ink); letter-spacing:.18em;}
  .pill.hot{
    border-color: rgba(255,210,120,.28);
    color: rgba(255,235,190,.92);
    box-shadow: 0 0 18px rgba(255,210,120,.08);
  }
  .pill.danger{
    border-color: rgba(255,120,140,.28);
    color: rgba(255,200,210,.92);
    box-shadow: 0 0 18px rgba(255,120,140,.08);
  }

  .right{margin-left:auto; display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;}
  .left{display:flex; gap:10px; flex-wrap:wrap; align-items:center; min-width:0;}

  .main{
    height:100%;
    min-height:0;
    display:grid;
    grid-template-columns: 380px 1fr 380px;
    gap:var(--gap);
  }

  .panel{
    background:
      radial-gradient(800px 500px at 50% 0%, rgba(202,163,90,.07), transparent 60%),
      linear-gradient(180deg, rgba(25,18,12,.70), rgba(12,8,5,.55));
    border:1px solid var(--line2);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    position:relative;
    overflow:hidden;
    min-height:0;
  }
  .panel::after{
    content:"";
    position:absolute; inset:0;
    background:
      linear-gradient(var(--line),var(--line)) left 12px top 12px/18px 1px no-repeat,
      linear-gradient(var(--line),var(--line)) left 12px top 12px/1px 18px no-repeat,
      linear-gradient(var(--line),var(--line)) right 12px top 12px/18px 1px no-repeat,
      linear-gradient(var(--line),var(--line)) right 12px top 12px/1px 18px no-repeat,
      linear-gradient(var(--line),var(--line)) left 12px bottom 12px/18px 1px no-repeat,
      linear-gradient(var(--line),var(--line)) left 12px bottom 12px/1px 18px no-repeat,
      linear-gradient(var(--line),var(--line)) right 12px bottom 12px/18px 1px no-repeat,
      linear-gradient(var(--line),var(--line)) right 12px bottom 12px/1px 18px no-repeat;
    opacity:.65;
    pointer-events:none;
  }

  .hdr{
    padding:10px 12px 8px;
    border-bottom:1px dashed var(--line2);
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
  }
  .hdr .title{
    font-size:12px;
    letter-spacing:.22em;
    text-transform:uppercase;
    color:var(--ink);
    white-space:nowrap;
  }
  .hdr .chip{
    font-size:11px;
    letter-spacing:.18em;
    text-transform:uppercase;
    color:var(--dim);
    border:1px solid var(--line2);
    background: rgba(0,0,0,.18);
    border-radius:999px;
    padding:3px 8px;
    white-space:nowrap;
  }
  .body{
    padding:12px;
    height: calc(100% - 44px);
    min-height:0;
    position:relative;
    display:grid;
    gap:12px;
  }

  .card{
    border:1px solid rgba(202,163,90,.18);
    border-radius:14px;
    background: rgba(0,0,0,.18);
    padding:12px;
  }
  .cardTitle{
    font-size:11px;
    letter-spacing:.18em;
    text-transform:uppercase;
    color:var(--dim);
  }
  .cardTitle b{color:var(--ink); letter-spacing:.22em;}
  .rows{ margin-top:10px; display:grid; gap:10px; }
  .rowLine{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    font-size:12px;
    color:rgba(243,231,207,.80);
    letter-spacing:.06em;
  }
  .rowLine .val{
    letter-spacing:.14em;
    text-transform:uppercase;
    color:var(--ink);
    white-space:nowrap;
  }

  .bigCenter{
    border:1px solid rgba(202,163,90,.18);
    border-radius:18px;
    background:
      radial-gradient(900px 520px at 50% 10%, rgba(202,163,90,.14), transparent 60%),
      radial-gradient(700px 520px at 30% 70%, rgba(0,0,0,.35), transparent 65%),
      linear-gradient(180deg, rgba(35,25,15,.78), rgba(10,7,4,.55));
    box-shadow: inset 0 0 0 1px rgba(0,0,0,.20), inset 0 0 60px rgba(0,0,0,.22);
    overflow:hidden;
    padding:16px;
    display:flex;
    flex-direction:column;
    justify-content:space-between;
    min-height:0;
  }
  .titleBig{
    font-weight:900;
    letter-spacing:.22em;
    text-transform:uppercase;
    font-size:14px;
  }
  .subBig{
    margin-top:10px;
    color:rgba(243,231,207,.78);
    letter-spacing:.06em;
    line-height:1.45;
    font-size:12px;
    max-width: 72ch;
  }

  .prompt{
    border:1px solid rgba(202,163,90,.18);
    border-radius:14px;
    background: rgba(0,0,0,.18);
    padding:10px 12px;
    box-shadow: 0 0 22px rgba(202,163,90,.06);
    text-align:center;
    letter-spacing:.18em;
    text-transform:uppercase;
    color:var(--dim);
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }
  .prompt.good{ border-color: rgba(160,255,210,.22); color: rgba(210,255,235,.95); }
  .prompt.bad{ border-color: rgba(255,120,140,.22); color: rgba(255,200,210,.95); }
  .prompt.warn{ border-color: rgba(255,210,120,.22); color: rgba(255,235,190,.95); }

  .btnRow{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
  .btnRow3{ display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px; }
  .btnRow2{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; }

  .btn{
    border-radius:14px;
    border:1px solid rgba(202,163,90,.22);
    background: radial-gradient(circle at 30% 25%, rgba(202,163,90,.10), rgba(0,0,0,.22));
    color:var(--ink);
    letter-spacing:.18em;
    text-transform:uppercase;
    font-size:11px;
    padding:12px 10px;
    cursor:pointer;
    user-select:none;
    transition: transform 80ms ease, border-color .2s ease, box-shadow .2s ease;
  }
  .btn:hover{
    border-color: rgba(255,235,190,.28);
    box-shadow: 0 0 22px rgba(202,163,90,.08);
  }
  .btn:active{ transform: translateY(1px); }
  .btn.danger{ border-color: rgba(255,120,140,.22); }
  .btn.disabled{ opacity:.45; cursor:not-allowed; }

  .log{
    height:100%;
    min-height:0;
    overflow:hidden;
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  .logList{
    flex:1;
    min-height:0;
    overflow:auto;
    border:1px solid rgba(202,163,90,.14);
    border-radius:14px;
    background: rgba(0,0,0,.16);
    padding:10px;
    line-height:1.35;
    color: rgba(243,231,207,.78);
    white-space:pre-wrap;
  }

  .keys{
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    font-size:11px;
    letter-spacing:.12em;
    text-transform:uppercase;
    color:var(--dim);
  }
  .key{
    border:1px solid rgba(202,163,90,.16);
    background: rgba(0,0,0,.18);
    border-radius:999px;
    padding:6px 10px;
    user-select:none;
  }
  .key b{color:var(--ink); letter-spacing:.18em;}

  @media (max-width: 980px){
  /* Hide dev-only folder paths on mobile */
  .panel:nth-child(3){
    display: none;
  }

  /* Rebalance layout after hiding panel */
  .main{
    grid-template-columns: 1fr;
    grid-template-rows: 1fr;
  }
}

</style>
</head>
<body>
  <div class="wrap">
    <div class="bar">
      <div class="row">
        <div class="left">
          <span class="pill">Bench: <b id="bench">Crowbar-12</b></span>
          <span class="pill">Run: <b id="runName">Endurance</b></span>
          <span class="pill">Best Streak: <b id="bestRun">0</b></span>
          <span class="pill">Wallet: <b id="wallet">$0</b></span>
        </div>
        <div class="right">
          <span class="pill">Uptime: <b id="uptime">00:00:00</b></span>
          <span class="pill">Clock: <b id="clock">--:--:--</b></span>
          <span class="pill">Press <b>1</b>/<b>2</b>/<b>3</b>/<b>4</b> Start • <b>B</b> Bench • <b>R</b> Reset Stats</span>
        </div>
      </div>
    </div>

    <div class="main">
      <!-- LEFT: STATS -->
      <div class="panel">
        <div class="hdr">
          <div class="title">Run Status</div>
          <div class="chip">Ledger</div>
        </div>
        <div class="body">
          <div class="card">
            <div class="cardTitle"><b>Account</b> Totals</div>
            <div class="rows">
              <div class="rowLine"><span>Total Cracks</span><span class="val" id="cracks">0</span></div>
              <div class="rowLine"><span>Total Jams</span><span class="val" id="jams">0</span></div>
              <div class="rowLine"><span>Wallet</span><span class="val" id="wallet2">$0</span></div>
            </div>
          </div>

          <div class="card">
            <div class="cardTitle"><b>Endurance</b> Records</div>
            <div class="rows">
              <div class="rowLine"><span>Best Streak</span><span class="val" id="bestRun2">0</span></div>
              <div class="rowLine"><span>Current Streak</span><span class="val" id="curRun">0</span></div>
              <div class="rowLine"><span>Last Safe</span><span class="val" id="lastSafe">—</span></div>
            </div>
          </div>

          <div class="prompt" id="leftPrompt">SELECT A VAULT • START ENDURANCE</div>
        </div>
      </div>

      <!-- CENTER: BRIEFING -->
      <div class="panel">
        <div class="hdr">
          <div class="title">Briefing</div>
          <div class="chip">No Mistakes</div>
        </div>
        <div class="body">
          <div class="bigCenter">
            <div>
              <div class="titleBig">ENDURANCE RUN</div>
              <div class="subBig">
                You are racing the window. Each safe is a sprint.
                <br><br>
                <b>Rule:</b> the crack window resets after each correct tumbler commit — but the run keeps tightening.
                <br><br>
                Pick a lock type and survive as many opens as you can before the jam.
              </div>
            </div>

            <div style="display:grid; gap:10px;">
              <div class="prompt" id="centerPrompt">READY • CHOOSE YOUR START</div>

              <div class="btnRow3">
                <button class="btn" id="startIron">Start Iron (Innocent)</button>
                <button class="btn" id="startSteel">Start Steel (Double)</button>
                <button class="btn" id="benchBtn">Back to Bench</button>
              </div>

              <!-- NEW: two extra vault buttons -->
              <div class="btnRow2">
                <button class="btn" id="startBronze">Start Bronze</button>
                <button class="btn" id="startDial">Start Dial Safe</button>
              </div>

              <div class="btnRow">
                <button class="btn" id="clearRecent">Clear Run Log</button>
                <button class="btn danger" id="resetAll">Reset All Stats</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- RIGHT: RECENT -->
      <div class="panel">
        <div class="hdr">
          <div class="title">Run Log</div>
          <div class="chip">Recent</div>
        </div>
        <div class="body log">
          <div class="prompt" id="logPrompt">LAST 10 EVENTS</div>
          <div class="logList" id="logList">—</div>
        </div>
      </div>
    </div>

    <div class="bar">
      <div class="row">
        <div class="keys">
          <span class="key"><b>1</b> Iron</span>
          <span class="key"><b>2</b> Steel</span>
          <span class="key"><b>3</b> Bronze</span>
          <span class="key"><b>4</b> Dial Safe</span>
          <span class="key"><b>B</b> Bench</span>
          <span class="key"><b>R</b> Reset Stats</span>
        </div>
        <div class="keys">
          <span class="key">Status: <b id="status">Idle</b></span>
        </div>
      </div>
    </div>
  </div>

  <div class="grain"></div>
  <div class="vignette"></div>

<script>
(() => {
  const $ = (s) => document.querySelector(s);
  const pad2 = (n) => String(n).padStart(2,"0");

  /* ===== Shared save keys ===== */
  const K = {
    money: "sc_money",
    cracks: "sc_totalCracks",
    jams: "sc_totalJams",
    bestRun: "sc_bestRun",
    recent: "sc_recent",
    bench: "sc_bench",
    curRun: "sc_curRun",
    lastSafe: "sc_lastSafe"
  };

  function getNum(key, def=0){
    const v = localStorage.getItem(key);
    const n = Number(v);
    return Number.isFinite(n) ? n : def;
  }
  function setNum(key, val){
    localStorage.setItem(key, String(Math.max(0, Math.floor(val))));
  }
  function getJSON(key, def){
    try{
      const raw = localStorage.getItem(key);
      if(!raw) return def;
      return JSON.parse(raw);
    }catch(e){ return def; }
  }
  function setJSON(key, val){
    localStorage.setItem(key, JSON.stringify(val));
  }

  // seed
  if(localStorage.getItem(K.money) === null) setNum(K.money, 0);
  if(localStorage.getItem(K.cracks) === null) setNum(K.cracks, 0);
  if(localStorage.getItem(K.jams) === null) setNum(K.jams, 0);
  if(localStorage.getItem(K.bestRun) === null) setNum(K.bestRun, 0);
  if(localStorage.getItem(K.recent) === null) setJSON(K.recent, []);
  if(localStorage.getItem(K.bench) === null) localStorage.setItem(K.bench, "Crowbar-12");
  if(localStorage.getItem(K.curRun) === null) setNum(K.curRun, 0);
  if(localStorage.getItem(K.lastSafe) === null) localStorage.setItem(K.lastSafe, "—");

  /* ===== Clock + uptime ===== */
  const start = Date.now();
  function tickTop(){
    const now = new Date();
    $("#clock").textContent = `${pad2(now.getHours())}:${pad2(now.getMinutes())}:${pad2(now.getSeconds())}`;
    const t = Math.floor((Date.now()-start)/1000);
    const h = Math.floor(t/3600), m = Math.floor((t%3600)/60), s = t%60;
    $("#uptime").textContent = `${pad2(h)}:${pad2(m)}:${pad2(s)}`;
  }
  setInterval(tickTop, 250);
  tickTop();

  function render(){
    const bench = localStorage.getItem(K.bench) || "Crowbar-12";
    $("#bench").textContent = bench;

    const money = getNum(K.money, 0);
    const cracks = getNum(K.cracks, 0);
    const jams = getNum(K.jams, 0);
    const best = getNum(K.bestRun, 0);
    const cur = getNum(K.curRun, 0);
    const lastSafe = localStorage.getItem(K.lastSafe) || "—";

    $("#wallet").textContent = `$${money}`;
    $("#wallet2").textContent = `$${money}`;
    $("#cracks").textContent = String(cracks);
    $("#jams").textContent = String(jams);
    $("#bestRun").textContent = String(best);
    $("#bestRun2").textContent = String(best);
    $("#curRun").textContent = String(cur);
    $("#lastSafe").textContent = lastSafe;

    const recent = getJSON(K.recent, []);
    $("#logList").textContent = recent.length ? recent.join("\n") : "—";
  }

  function pushRecent(line){
    const recent = getJSON(K.recent, []);
    const out = [String(line), ...recent].slice(0, 10);
    setJSON(K.recent, out);
  }

  function clearRecent(){
    setJSON(K.recent, []);
    pushRecent("RUN LOG CLEARED.");
    render();
  }

  function setStatus(txt, kind){
    $("#status").textContent = txt;

    const p1 = $("#centerPrompt");
    const p2 = $("#leftPrompt");
    const p3 = $("#logPrompt");

    [p1,p2,p3].forEach(p => p.classList.remove("good","bad","warn"));
    if(kind){
      [p1,p2].forEach(p => p.classList.add(kind));
    }
    p1.textContent = txt;
    p2.textContent = kind === "bad" ? "RUN FAILED • TRY AGAIN" : "SELECT A VAULT • START ENDURANCE";
  }

  // IMPORTANT: we are inside /endurance/, safes are in ../safes/
 function go(which){
  // tell the next page we are in ENDURANCE
  localStorage.setItem("sc_mode", "endurance");

  localStorage.setItem(K.lastSafe, which);
  pushRecent(`ENDURANCE START: ${which}`);
  setStatus(`LAUNCHING • ${which}`, "warn");
  render();

  // launch the correct safe WITH a mode flag
  if(which === "INNOCENT (IRON)") location.href = "./innocent.html?mode=endurance";
  if(which === "DOUBLE TUMBLER (STEEL)") location.href = "./double-tumbler.html?mode=endurance";
}

  function resetAll(){
    setNum(K.money, 0);
    setNum(K.cracks, 0);
    setNum(K.jams, 0);

    setNum(K.bestRun, 0);
    setNum(K.curRun, 0);
    localStorage.setItem(K.lastSafe, "—");

    setJSON(K.recent, []);
    pushRecent("STATS RESET.");
    setStatus("RESET COMPLETE", "warn");
    render();
    setTimeout(()=> setStatus("READY • CHOOSE YOUR START", ""), 1100);
  }

  // wire
  $("#startIron").addEventListener("click", () => go("INNOCENT (IRON)"));
  $("#startSteel").addEventListener("click", () => go("DOUBLE TUMBLER (STEEL)"));
  $("#startBronze").addEventListener("click", () => go("BRONZE"));
  $("#startDial").addEventListener("click", () => go("DIAL SAFE"));

  $("#benchBtn").addEventListener("click", () => location.href = "../index.html");
  $("#clearRecent").addEventListener("click", clearRecent);
  $("#resetAll").addEventListener("click", resetAll);

  window.addEventListener("keydown", (e) => {
    const k = e.key.toLowerCase();
    if(k === "1") go("INNOCENT (IRON)");
    if(k === "2") go("DOUBLE TUMBLER (STEEL)");
    if(k === "3") go("BRONZE");
    if(k === "4") go("DIAL SAFE");
    if(k === "b") location.href = "../index.html";
    if(k === "r") resetAll();
  });

  // init
  pushRecent("OPENED: Endurance Run Hub.");
  setStatus("READY • CHOOSE YOUR START", "");
  render();
})();
</script>
</body>
</html>


